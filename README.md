# Quality Control software for Diagnosing RNA-seq (QC DR)

This is a software package designed to facilitate RNA-seq Quality Control analysis by creating visualizations and performing for key QC metrics. 

This software is currently in alpha, made available early to align with ISCB 2023. Expect updates as we clean up the interface and fix any potential bugs. If you run into any bugs using this software, please leave a report for us. Additional information on methods will be published along with the paper in the future.

QCDR is written in Python and designed to be run in command line.
For ease of user, QCDR comes with a containerized environment for use. It can be activated using 

source activate QCDRenv 

Once the environment is activated, the only file that needs to be filled with information is the input file. At its most simple, the User_Input.csv file contained within the data/User_Template folder should be filled with information about the User's data. If a user does not wish to supply data for a given metric, the column can be left blank. Once filled, the main command can be run by navigating to the software folder and entering 

python3 pyRetroPlotter_main.py -ip ../data/User_Template/User_Input.csv -out /path/to/outlocation.pdf -bgd ../data/User_Template/User_Input.csv

In the case the user would like a different dataset to be used as the background distribution, it can be specified. For example.

python3 pyRetroPlotter_main.py -ip ../data/User_Template/User_Input.csv -out /path/to/outlocation.pdf -bgd ../data/SCRIPT/SCRIPT_stats_albatches.csv

By default, the fail and warn cutoffs generated by QCDR are at .05 and .1 significance levels respectively. These can be modified using the -f and -w options. For example.


python3 pyRetroPlotter_main.py -ip ../data/User_Template/User_Input.csv -out /path/to/outlocation.pdf -bgd ../data/User_Template/User_Input.csv -w .01 -f .001

Would shift these cutoffs.

Critically, there are two additional figures subfigures that can be generated from QCDR that require separate inputs.

For ease of use, we have included an R function which can generate the required file from a CPM normalized count matrix. An example of the count matrix required for this function is included at /data/SCRIPT/SCRIPT_CountTable.xlsx. Files like these can be transformed into the required input format by 

Rscript mkhistfrmcpm.R -f ../data/SCRIPT/SCRIPT_CountTable.xlsx -o /path/to/output

Once created, it can be included within the main function by

python3 pyRetroPlotter_main.py -ip ../data/User_Template/User_Input.csv -out /path/to/outlocation.pdf -bgd ../data/User_Template/User_Input.csv -hist /histdataloc.csv

 gene coverage distribution plot can also be created. This requires inputting an additional table describing the normalized gene body coverage across samples. We have built a separate tool to generate these tables. The software and instructions for use can be found at https://github.com/hamsamilton/ezGBC. An example file can be found at data/SCRIPT/SCRIPT_B11_GC_info.cs

python3 pyRetroPlotter_main.py -ip ../data/User_Template/User_Input.csv -out /path/to/outlocation.pdf -bgd ../data/User_Template/User_Input.csv -gc gcdata.csv

Include info on how to generate from RseQC soon.

Last, cutoffs can be set to specific values by filling the values in the data/User_Template/user_cutoff_table.xlsx file.
For all metrics except for the hist and gc cutoffs, these should be raw values. For the hist and gc cutoffs, these must be significance levels. If the user does not want to set a metric, the cell can be left blank.

These can be included using the -ctf argument. For example

python3 pyRetroPlotter_main.py -ip ../data/User_Template/User_Input.csv -out /path/to/outlocation.pdf -bgd ../data/User_Template/User_Input.csv. -ctf USER_cutoff_table.xlsx



